<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.55">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Machine_Learning_HW2 – Statsergeant</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<link href="./Machine_learning_hw3.html" rel="next">
<link href="./Machine_learning_hw1.html" rel="prev">
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="site_libs/kePrint-0.0.1/kePrint.js"></script>

<link href="site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">


  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./Machine_learning_hw1.html">Machine_Learning</a></li><li class="breadcrumb-item"><a href="./Machine_learning_hw2.html">Machine_Learning_HW2</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Statsergeant</a> 
        <div class="sidebar-tools-main tools-wide">
    <a href="https://github.com/Statsergeant/UNC" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-github"></i></a>
    <a href="" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-instagram"></i></a>
    <a href="" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-twitter"></i></a>
    <a href="" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-facebook"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Introduction</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">About ME</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Masters_thesis</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Masters_thesis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">2024_Spring_statistical_consulting</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Fall2023_stat_consulting.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">2023_Fall_statistical_consulting</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Machine_Learning</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Machine_learning_hw1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Machine_Learning_HW1</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Machine_learning_hw2.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Machine_Learning_HW2</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Machine_learning_hw3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Machine_Learning_HW3</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Machine_learning_hw4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Machine_Learning_HW4</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Machine_learning_hw5.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Machine_Learning_HW5</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#question-1" id="toc-question-1" class="nav-link active" data-scroll-target="#question-1">Question 1</a></li>
  <li><a href="#question-2" id="toc-question-2" class="nav-link" data-scroll-target="#question-2">Question 2</a></li>
  <li><a href="#question-3" id="toc-question-3" class="nav-link" data-scroll-target="#question-3">Question 3</a></li>
  <li><a href="#question-4" id="toc-question-4" class="nav-link" data-scroll-target="#question-4">Question 4</a></li>
  <li><a href="#question-5" id="toc-question-5" class="nav-link" data-scroll-target="#question-5">Question 5</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./Machine_learning_hw1.html">Machine_Learning</a></li><li class="breadcrumb-item"><a href="./Machine_learning_hw2.html">Machine_Learning_HW2</a></li></ol></nav>
<div class="quarto-title">
<h1 class="title">Machine_Learning_HW2</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p><br> Open the data set <code>Wage</code> in the R package <code>ISLR</code>. The data information is available with <code>?Wage</code>. The variable logwage is considered as a response variable and other 8 variables including <strong>‘year’</strong>, <strong>‘age’</strong>, <strong>‘maritl’</strong>, <strong>‘race’</strong>, <strong>‘education’</strong>, <strong>‘jobclass’</strong>, <strong>‘health’</strong>, and <strong>‘health ins’</strong> are considered as predictors. Since there are 8 predictors, a total of 28 − 1 = 255 regression models should be considered.</p>
<section id="question-1" class="level2">
<h2 class="anchored" data-anchor-id="question-1">Question 1</h2>
<p>Let us define AIC (Akaike information criterion) and BIC (Bayesian information criterion) as <span class="math display">\[
\text{AIC} = n \log\left(\frac{1}{n} \sum_{i=1}^{n} (y_i - \hat{f}(x_i))^2\right) + 2d
\]</span> and <span class="math display">\[
\text{BIC} = n \log\left(\frac{1}{n} \sum_{i=1}^{n} (y_i - \hat{f}(x_i))^2\right) + d \log(n)
\]</span></p>
<p>respectively. <span class="math inline">\(\hat{f}(.)\)</span> is the estimated linear regression model and d is the number of regression coefficients in the model. For example, if 8 predictors are all included in the model, d = 17 due to dummy variables. Next, separate individuals into two groups based on their <strong>logwage</strong> value; group 1 is for <strong>median(logwage)</strong> and group 2 is for ≤ <strong>median(logwage)</strong>. Note that the sample size n should be regarded as a group size when AIC(BIC) is computed. For each group, find the best model among 255 models in terms of AIC and BIC, and provide the numerical values of AIC and BIC of the best models.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(Wage)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>wage <span class="ot">&lt;-</span> Wage[,<span class="sc">-</span><span class="fu">c</span>(<span class="dv">6</span>,<span class="dv">11</span>)]</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> wage[,<span class="dv">9</span>]</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>grid <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="fu">rep</span>(<span class="fu">list</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>)),<span class="dv">8</span>))[<span class="sc">-</span><span class="dv">1</span>,]</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>grp1 <span class="ot">&lt;-</span> (y <span class="sc">&gt;</span> <span class="fu">median</span>(y))</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>grp2 <span class="ot">&lt;-</span> <span class="sc">!</span>grp1</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>grp1.size <span class="ot">&lt;-</span> <span class="fu">sum</span>(grp1)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>grp2.size <span class="ot">&lt;-</span> <span class="fu">sum</span>(grp2)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>grp1.aic <span class="ot">&lt;-</span> grp1.bic <span class="ot">&lt;-</span> grp2.aic <span class="ot">&lt;-</span> grp2.bic <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(grid)){</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a> wage.data <span class="ot">&lt;-</span> wage[,<span class="fu">c</span>(grid[i,] <span class="sc">%in%</span> <span class="dv">1</span>,<span class="cn">TRUE</span>)]</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a> grp1.lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(logwage<span class="sc">~</span>.,<span class="at">data=</span>wage.data,<span class="at">subset=</span>grp1)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a> grp1.mse <span class="ot">&lt;-</span> <span class="fu">mean</span>((y[grp1]<span class="sc">-</span> grp1.lm<span class="sc">$</span>fitted)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a> grp1.aic[i] <span class="ot">&lt;-</span> grp1.size<span class="sc">*</span><span class="fu">log</span>(grp1.mse)<span class="sc">+</span><span class="dv">2</span><span class="sc">*</span><span class="fu">length</span>(<span class="fu">coef</span>(grp1.lm))</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a> grp1.bic[i] <span class="ot">&lt;-</span> grp1.size<span class="sc">*</span><span class="fu">log</span>(grp1.mse)<span class="sc">+</span><span class="fu">length</span>(<span class="fu">coef</span>(grp1.lm))<span class="sc">*</span><span class="fu">log</span>(grp1.size)</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a> grp2.lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(logwage<span class="sc">~</span>.,<span class="at">data=</span>wage.data,<span class="at">subset=</span>grp2)</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a> grp2.mse <span class="ot">&lt;-</span> <span class="fu">mean</span>((y[grp2]<span class="sc">-</span> grp2.lm<span class="sc">$</span>fitted)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a> grp2.aic[i] <span class="ot">&lt;-</span> grp2.size<span class="sc">*</span><span class="fu">log</span>(grp2.mse)<span class="sc">+</span><span class="dv">2</span><span class="sc">*</span><span class="fu">length</span>(<span class="fu">coef</span>(grp2.lm))</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a> grp2.bic[i] <span class="ot">&lt;-</span> grp2.size<span class="sc">*</span><span class="fu">log</span>(grp2.mse)<span class="sc">+</span><span class="fu">length</span>(<span class="fu">coef</span>(grp2.lm))<span class="sc">*</span><span class="fu">log</span>(grp2.size)</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>grp1.aic.pos <span class="ot">&lt;-</span> <span class="fu">which</span>(grp1.aic<span class="sc">==</span><span class="fu">min</span>(grp1.aic))</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>grp1.aic.min <span class="ot">&lt;-</span> <span class="fu">min</span>(grp1.aic)</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>grp1.bic.pos <span class="ot">&lt;-</span> <span class="fu">which</span>(grp1.bic<span class="sc">==</span><span class="fu">min</span>(grp1.bic))</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>grp1.bic.min <span class="ot">&lt;-</span> <span class="fu">min</span>(grp1.bic)</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>grp1.aic.best <span class="ot">&lt;-</span> grid[grp1.aic.pos,]</span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>grp1.bic.best <span class="ot">&lt;-</span> grid[grp1.bic.pos,]</span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>grp1.aic.ans <span class="ot">&lt;-</span> <span class="fu">cbind</span>(grp1.aic.best,grp1.aic.min)</span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>grp1.bic.ans <span class="ot">&lt;-</span> <span class="fu">cbind</span>(grp1.bic.best,grp1.bic.min)</span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(grp1.aic.ans) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">colnames</span>(wage)[<span class="sc">-</span><span class="dv">9</span>],<span class="st">'AIC'</span>)</span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(grp1.bic.ans) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">colnames</span>(wage)[<span class="sc">-</span><span class="dv">9</span>],<span class="st">'BIC'</span>)</span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>grp2.aic.pos <span class="ot">&lt;-</span> <span class="fu">which</span>(grp2.aic<span class="sc">==</span><span class="fu">min</span>(grp2.aic))</span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>grp2.aic.min <span class="ot">&lt;-</span> <span class="fu">min</span>(grp2.aic)</span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>grp2.bic.pos <span class="ot">&lt;-</span> <span class="fu">which</span>(grp2.bic<span class="sc">==</span><span class="fu">min</span>(grp2.bic))</span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a>grp2.bic.min <span class="ot">&lt;-</span> <span class="fu">min</span>(grp2.bic)</span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a>grp2.aic.best <span class="ot">&lt;-</span> grid[grp2.aic.pos,]</span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a>grp2.bic.best <span class="ot">&lt;-</span> grid[grp2.bic.pos,]</span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a>grp2.aic.ans <span class="ot">&lt;-</span> <span class="fu">cbind</span>(grp2.aic.best,grp2.aic.min)</span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a>grp2.bic.ans <span class="ot">&lt;-</span> <span class="fu">cbind</span>(grp2.bic.best,grp2.bic.min)</span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(grp2.aic.ans) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">colnames</span>(wage)[<span class="sc">-</span><span class="dv">9</span>],<span class="st">'AIC'</span>)</span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(grp2.bic.ans) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">colnames</span>(wage)[<span class="sc">-</span><span class="dv">9</span>],<span class="st">'BIC'</span>)</span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a>grp1.aic.ans <span class="sc">%&gt;%</span> <span class="fu">kable</span>() <span class="sc">%&gt;%</span> <span class="fu">kable_styling</span>(<span class="at">full_width =</span> F)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table caption-top table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: right;" data-quarto-table-cell-role="th">year</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">age</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">maritl</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">race</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">education</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">jobclass</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">health</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">health_ins</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">AIC</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">215</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">-4664.77</td>
</tr>
</tbody>
</table>


</div>
</div>
</section>
<section id="question-2" class="level2">
<h2 class="anchored" data-anchor-id="question-2">Question 2</h2>
<p>Perform 10-fold cross-validation to find the best model in terms of prediction error (PE), which can be defined as</p>
<p><span class="math display">\[
\text{PE} = \sqrt{\frac{1}{m} \sum_{i=1}^{m} \left( y_i - \hat{f}(x_i) \right)^2},
\]</span></p>
<p>where <span class="math inline">\(\hat{f}(.)\)</span> is the estimated linear regression using the training set and <span class="math inline">\(m\)</span> is the size of the test set. Use the following R code to generate 10 folds.</p>
<p><br> &gt; RNGkind(sample.kind = “Rounding”)<br> &gt; set.seed(111)<br> &gt; u1 &lt;- sample(rep(seq(10), length=sum(Wage<span class="math inline">\(logwage&gt;median(Wage\)</span>logwage))))<br> &gt; u2 &lt;- sample(rep(seq(10), length=sum(Wage<span class="math inline">\(logwage&lt;=median(Wage\)</span>logwage))))<br></p>
<p>Note that u1 is for group 1 and u2 is for group 2. For each group, two best models should be determined based on the minimum PE (minPE) and one-standard-error rule (1SE), respectively. Therefore, your result of group 1 can be summarized as<br></p>
<p><span class="math display">\[
\begin{array}{|c| c c c c c c |c|}
\hline
\text{group 1} &amp; \text{year} &amp; \text{age} &amp; \text{marit} &amp; \text{...} &amp; \text{health} &amp; \text{health\_ins} &amp; \text{PE}\\
\hline
\text{minPE} &amp; \text{0 or 1} &amp; &amp; &amp; &amp; &amp; &amp; \\
\text{1SE}  &amp; &amp; &amp; &amp; &amp; &amp; &amp; \\
\hline
\end{array}
\]</span></p>
<p>In the table, write ‘1’ if the corresponding predictor is included in the model, otherwise ‘0’. In the one-standard-error rule, the best model has both the smallest model size (i.e., the smallest number of predictors) and the smallest PE among all models within one standard error boundary. You have to provide a table for group 2.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">RNGkind</span>(<span class="at">sample.kind =</span> <span class="st">"Rounding"</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">111</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>u1 <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">rep</span>(<span class="fu">seq</span>(<span class="dv">10</span>), <span class="at">length=</span><span class="fu">sum</span>(Wage<span class="sc">$</span>logwage<span class="sc">&gt;</span><span class="fu">median</span>(Wage<span class="sc">$</span>logwage))))</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>u2 <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">rep</span>(<span class="fu">seq</span>(<span class="dv">10</span>), <span class="at">length=</span><span class="fu">sum</span>(Wage<span class="sc">$</span>logwage<span class="sc">&lt;=</span><span class="fu">median</span>(Wage<span class="sc">$</span>logwage))))</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>K <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>grp1.pe <span class="ot">&lt;-</span> grp2.pe <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,<span class="fu">nrow</span>(grid),K)</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>K){</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a> grp1.tran <span class="ot">&lt;-</span> <span class="fu">which</span>(u1<span class="sc">!=</span>k)</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a> grp1.test <span class="ot">&lt;-</span> <span class="fu">which</span>(u1<span class="sc">==</span>k)</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a> grp2.tran <span class="ot">&lt;-</span> <span class="fu">which</span>(u2<span class="sc">!=</span>k)</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a> grp2.test <span class="ot">&lt;-</span> <span class="fu">which</span>(u2<span class="sc">==</span>k)</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a> <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(grid)){</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a> <span class="co">#group 1</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a> grp1.wage <span class="ot">&lt;-</span> wage[grp1,<span class="fu">c</span>(grid[i,] <span class="sc">%in%</span> <span class="dv">1</span>,<span class="cn">TRUE</span>)]</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a> grp1.lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(logwage<span class="sc">~</span>.,<span class="at">data=</span>grp1.wage,<span class="at">subset=</span>grp1.tran)</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a> grp1.pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(grp1.lm,grp1.wage)</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a> grp1.pe[i,k] <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>((y[grp1]<span class="sc">-</span>grp1.pred)[grp1.test]<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a> <span class="co">#group 2</span></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a> grp2.wage <span class="ot">&lt;-</span> wage[grp2,<span class="fu">c</span>(grid[i,] <span class="sc">%in%</span> <span class="dv">1</span>,<span class="cn">TRUE</span>)]</span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a> grp2.lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(logwage<span class="sc">~</span>.,<span class="at">data=</span>grp2.wage,<span class="at">subset=</span>grp2.tran)</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a> grp2.pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(grp2.lm,grp2.wage)</span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a> grp2.pe[i,k] <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>((y[grp2]<span class="sc">-</span>grp2.pred)[grp2.test]<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a> }</span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>grp1.ave.pe <span class="ot">&lt;-</span> <span class="fu">apply</span>(grp1.pe,<span class="dv">1</span>,mean)</span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>grp1.min.pe <span class="ot">&lt;-</span> <span class="fu">min</span>(grp1.ave.pe)</span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a>grp1.min.pos <span class="ot">&lt;-</span> <span class="fu">which</span>(grp1.ave.pe<span class="sc">==</span><span class="fu">min</span>(grp1.ave.pe))</span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a>grp1.min.model <span class="ot">&lt;-</span> <span class="fu">c</span>(grid[grp1.min.pos,],grp1.min.pe)</span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a>grp1.se.pe <span class="ot">&lt;-</span> <span class="fu">apply</span>(grp1.pe,<span class="dv">1</span>,sd)</span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a>grp1.add.pe <span class="ot">&lt;-</span> grp1.ave.pe <span class="sc">+</span> grp1.se.pe</span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a>grp1<span class="fl">.1</span>se.temp <span class="ot">&lt;-</span> <span class="fu">which</span>(grp1.ave.pe <span class="sc">&lt;</span> grp1.add.pe[grp1.min.pos])</span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a>grp1<span class="fl">.1</span>se.num <span class="ot">&lt;-</span> <span class="fu">apply</span>(grid[grp1<span class="fl">.1</span>se.temp,],<span class="dv">1</span>,sum)</span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a>grp1<span class="fl">.1</span>se.pe <span class="ot">&lt;-</span> grp1.ave.pe[grp1<span class="fl">.1</span>se.temp[<span class="fu">which</span>(grp1<span class="fl">.1</span>se.num<span class="sc">==</span><span class="fu">min</span>(grp1<span class="fl">.1</span>se.num))]]</span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a>grp1<span class="fl">.1</span>se.model <span class="ot">&lt;-</span></span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(grid[grp1<span class="fl">.1</span>se.temp[<span class="fu">which</span>(grp1<span class="fl">.1</span>se.num<span class="sc">==</span><span class="fu">min</span>(grp1<span class="fl">.1</span>se.num))],],grp1<span class="fl">.1</span>se.pe)</span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true" tabindex="-1"></a>grp1.ans <span class="ot">&lt;-</span> <span class="fu">rbind</span>(grp1.min.model,grp1<span class="fl">.1</span>se.model)</span>
<span id="cb2-37"><a href="#cb2-37" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(grp1.ans) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">colnames</span>(wage)[<span class="sc">-</span><span class="dv">9</span>],<span class="st">'PE'</span>)</span>
<span id="cb2-38"><a href="#cb2-38" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(grp1.ans) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'minPE'</span>,<span class="st">'1SE'</span>)</span>
<span id="cb2-39"><a href="#cb2-39" aria-hidden="true" tabindex="-1"></a>grp2.ave.pe <span class="ot">&lt;-</span> <span class="fu">apply</span>(grp2.pe,<span class="dv">1</span>,mean)</span>
<span id="cb2-40"><a href="#cb2-40" aria-hidden="true" tabindex="-1"></a>grp2.min.pe <span class="ot">&lt;-</span> <span class="fu">min</span>(grp2.ave.pe)</span>
<span id="cb2-41"><a href="#cb2-41" aria-hidden="true" tabindex="-1"></a>grp2.min.pos <span class="ot">&lt;-</span> <span class="fu">which</span>(grp2.ave.pe<span class="sc">==</span><span class="fu">min</span>(grp2.ave.pe))</span>
<span id="cb2-42"><a href="#cb2-42" aria-hidden="true" tabindex="-1"></a>grp2.min.model <span class="ot">&lt;-</span> <span class="fu">c</span>(grid[grp2.min.pos,],grp2.min.pe)</span>
<span id="cb2-43"><a href="#cb2-43" aria-hidden="true" tabindex="-1"></a>grp2.se.pe <span class="ot">&lt;-</span> <span class="fu">apply</span>(grp2.pe,<span class="dv">1</span>,sd)</span>
<span id="cb2-44"><a href="#cb2-44" aria-hidden="true" tabindex="-1"></a>grp2.add.pe <span class="ot">&lt;-</span> grp2.ave.pe <span class="sc">+</span> grp2.se.pe</span>
<span id="cb2-45"><a href="#cb2-45" aria-hidden="true" tabindex="-1"></a>grp2<span class="fl">.1</span>se.temp <span class="ot">&lt;-</span> <span class="fu">which</span>(grp2.ave.pe <span class="sc">&lt;</span> grp2.add.pe[grp2.min.pos])</span>
<span id="cb2-46"><a href="#cb2-46" aria-hidden="true" tabindex="-1"></a>grp2<span class="fl">.1</span>se.num <span class="ot">&lt;-</span> <span class="fu">apply</span>(grid[grp2<span class="fl">.1</span>se.temp,],<span class="dv">1</span>,sum)</span>
<span id="cb2-47"><a href="#cb2-47" aria-hidden="true" tabindex="-1"></a>grp2<span class="fl">.1</span>se.pe <span class="ot">&lt;-</span> grp2.ave.pe[grp2<span class="fl">.1</span>se.temp[<span class="fu">which</span>(grp2<span class="fl">.1</span>se.num<span class="sc">==</span><span class="fu">min</span>(grp2<span class="fl">.1</span>se.num))]]</span>
<span id="cb2-48"><a href="#cb2-48" aria-hidden="true" tabindex="-1"></a>grp2<span class="fl">.1</span>se.sm.pe <span class="ot">&lt;-</span> <span class="fu">min</span>(grp2<span class="fl">.1</span>se.pe)</span>
<span id="cb2-49"><a href="#cb2-49" aria-hidden="true" tabindex="-1"></a>grp2<span class="fl">.1</span>se.sm.pos <span class="ot">&lt;-</span> <span class="fu">which.min</span>(grp2<span class="fl">.1</span>se.pe)</span>
<span id="cb2-50"><a href="#cb2-50" aria-hidden="true" tabindex="-1"></a>grp2<span class="fl">.1</span>se.pos <span class="ot">&lt;-</span> <span class="fu">which</span>(grp2<span class="fl">.1</span>se.num<span class="sc">==</span><span class="fu">min</span>(grp2<span class="fl">.1</span>se.num))[grp2<span class="fl">.1</span>se.sm.pos]</span>
<span id="cb2-51"><a href="#cb2-51" aria-hidden="true" tabindex="-1"></a>grp2<span class="fl">.1</span>se.model <span class="ot">&lt;-</span> <span class="fu">c</span>(grid[grp2<span class="fl">.1</span>se.pos,],grp2<span class="fl">.1</span>se.sm.pe)</span>
<span id="cb2-52"><a href="#cb2-52" aria-hidden="true" tabindex="-1"></a>grp2.ans <span class="ot">&lt;-</span> <span class="fu">rbind</span>(grp2.min.model,grp2<span class="fl">.1</span>se.model)</span>
<span id="cb2-53"><a href="#cb2-53" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(grp2.ans) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">colnames</span>(wage)[<span class="sc">-</span><span class="dv">9</span>],<span class="st">'PE'</span>)</span>
<span id="cb2-54"><a href="#cb2-54" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(grp2.ans) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'minPE'</span>,<span class="st">'1SE'</span>)</span>
<span id="cb2-55"><a href="#cb2-55" aria-hidden="true" tabindex="-1"></a>grp1.ans <span class="sc">%&gt;%</span> <span class="fu">kable</span>() <span class="sc">%&gt;%</span> <span class="fu">kable_styling</span>(<span class="at">full_width =</span> F)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table caption-top table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: left;" data-quarto-table-cell-role="th">year</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">age</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">maritl</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">race</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">education</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">jobclass</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">health</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">health_ins</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">PE</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">minPE</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">0.20686535635724</td>
</tr>
<tr class="even">
<td style="text-align: left;">1SE</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">0.209806791469152</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>Open the data set <code>NCI60</code> in the R package <code>ISLR</code>. The data information is available with <code>?NCI60</code>. The gene expression data consists of 64 samples for 6,830 genes, where we assume that the first 50 genes are only relevant. That is, only 50 among 6,830 genes are associated with a response outcome. Type the following R codes to generate x and y with 300 <strong>lambda</strong> values and <strong>foldid</strong> for 5-fold cross validation.</p>
<p><br> &gt; data(NCI60)<br> &gt; x &lt;- NCI60$data<br> &gt; RNGkind(sample.kind = “Rounding”)<br> &gt; set.seed(123)<br> &gt; beta &lt;- rep(0, ncol(x))<br> &gt; beta[1:50] &lt;- runif(50, -2, 2)<br> &gt; y &lt;- x %*% beta + rnorm(nrow(x))<br> &gt; lambda &lt;- 10^seq(2, -2, length=300)<br> &gt; foldid &lt;- sample(rep(seq(5), length=length(y)))<br></p>
<p>For the 5-fold cross validation, you must use <strong>lambda</strong> and <strong>foldid</strong> to answer the following questions.</p>
</section>
<section id="question-3" class="level2">
<h2 class="anchored" data-anchor-id="question-3">Question 3</h2>
<p>Apply the elastic-net for variable selection, where the tuning parameter <span class="math inline">\(\alpha\)</span> starts from 0 to 1 increased by 0.05. Perform the 5-fold cross validation to find out two optimal <strong>lambda</strong> values: <span class="math inline">\(\hat{\lambda}_{\min}\)</span> for the smallest prediction error and <span class="math inline">\(\hat{\lambda}_{1\text{se}}\)</span> for the one-standard-error rule. For computation of prediction errors, the default value of the <strong>glmnet</strong> package (mean squared errors) should be used. What is the optimal value of <span class="math inline">\(\hat{\alpha}\)</span> that minimizes the prediction error? Provide the numerical values of <span class="math inline">\(\hat{\lambda}_{\min}\)</span> and <span class="math inline">\(\hat{\lambda}_{1\text{se}}\)</span> for the corresponding <span class="math inline">\(\hat{\alpha}\)</span>. How many variables are selected by <span class="math inline">\(\hat{\lambda}_{\min}\)</span> and <span class="math inline">\(\hat{\lambda}_{1\text{se}}\)</span>, respectively?</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(NCI60)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> NCI60<span class="sc">$</span>data</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="fu">RNGkind</span>(<span class="at">sample.kind =</span> <span class="st">"Rounding"</span>)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>beta <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, <span class="fu">ncol</span>(x))</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>beta[<span class="dv">1</span><span class="sc">:</span><span class="dv">50</span>] <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">50</span>, <span class="sc">-</span><span class="dv">2</span>, <span class="dv">2</span>)</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> x <span class="sc">%*%</span> beta <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="fu">nrow</span>(x))</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(x) <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">'G'</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">6830</span>)</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>lambda <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">^</span><span class="fu">seq</span>(<span class="dv">2</span>, <span class="sc">-</span><span class="dv">2</span>, <span class="at">length=</span><span class="dv">300</span>)</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>foldid <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">rep</span>(<span class="fu">seq</span>(<span class="dv">5</span>), <span class="at">length=</span><span class="fu">length</span>(y)))</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="fl">0.05</span>)</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>cvm.q3 <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>lam.mat <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,<span class="dv">2</span>,<span class="fu">length</span>(alpha))</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(alpha)){</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a> cv.fit.q3 <span class="ot">&lt;-</span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a><span class="fu">cv.glmnet</span>(x,y,<span class="at">type.measure=</span><span class="st">'mse'</span>,<span class="at">alpha=</span>alpha[i],<span class="at">lambda=</span>lambda,<span class="at">foldid=</span>foldid)</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a> cvm.q3[i] <span class="ot">&lt;-</span> <span class="fu">min</span>(cv.fit.q3<span class="sc">$</span>cvm)</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a> lam.mat[<span class="dv">1</span>,i] <span class="ot">&lt;-</span> cv.fit.q3<span class="sc">$</span>lambda.min</span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a> lam.mat[<span class="dv">2</span>,i] <span class="ot">&lt;-</span> cv.fit.q3<span class="sc">$</span>lambda<span class="fl">.1</span>se</span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>alpha.pos <span class="ot">&lt;-</span> <span class="fu">which</span>(cvm.q3<span class="sc">==</span><span class="fu">min</span>(cvm.q3))</span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>alpha.hat <span class="ot">&lt;-</span> alpha[alpha.pos]</span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>lambda.min.hat <span class="ot">&lt;-</span> lam.mat[<span class="dv">1</span>,alpha.pos]</span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>lambda<span class="fl">.1</span>se.hat <span class="ot">&lt;-</span> lam.mat[<span class="dv">2</span>,alpha.pos]</span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a>cv.fit.q3 <span class="ot">&lt;-</span></span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a><span class="fu">cv.glmnet</span>(x,y,<span class="at">type.measure=</span><span class="st">'mse'</span>,<span class="at">alpha=</span>alpha.hat,<span class="at">lambda=</span>lambda,<span class="at">foldid=</span>foldid)</span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a>q3.min.coef.num <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">coef</span>(cv.fit.q3, <span class="at">s =</span> <span class="st">'lambda.min'</span>)<span class="sc">!=</span><span class="dv">0</span>)<span class="sc">-</span><span class="dv">1</span></span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a>q3<span class="fl">.1</span>se.coef.num <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">coef</span>(cv.fit.q3, <span class="at">s =</span> <span class="st">'lambda.1se'</span>)<span class="sc">!=</span><span class="dv">0</span>)<span class="sc">-</span><span class="dv">1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>The optimal value of <span class="math inline">\(\hat{\alpha}\)</span> = 0.65<br><br> The numerical value of <span class="math inline">\(\hat{\lambda}_{\min}\)</span> = 1.0800524<br> The numerical value of <span class="math inline">\(\hat{\lambda}_{1\text{se}}\)</span> = 2.4811261<br><br></p>
<p>The number of variables of <span class="math inline">\(\hat{\lambda}_{\min}\)</span> = 28<br> The number of variables of <span class="math inline">\(\hat{\lambda}_{1\text{se}}\)</span> = 12</p>
</section>
<section id="question-4" class="level2">
<h2 class="anchored" data-anchor-id="question-4">Question 4</h2>
<p>In the 5-fold cross validation, let us denote the number of training samples and the number of test samples by <span class="math inline">\(n_{tr}\)</span> and <span class="math inline">\(n_{te}\)</span>, respectively. Suppose that we select <span class="math inline">\(q\)</span> variables from training samples, i.e., only <span class="math inline">\(q + 1\)</span> regression coefficients including the intercept parameter are not zeros. Then, we newly define the prediction error as <span class="math display">\[
    \text{PE}_{\text{new}} = \sqrt{\frac{1}{n_{te}} \sum_{i=1}^{n_{te}} \left( y_i - \hat{\beta}_0 - \sum_{j=1}^{q_0} x_{ij} \hat{\beta}_j^* \right)^2},
    \]</span> where <span class="math inline">\(q_0 = \min(q, n_{tr} - 1)\)</span> and <span class="math inline">\(\hat{\beta}_j^*\)</span> is the ordinary least square estimate for the <span class="math inline">\(j\)</span>th selected variable. For each <span class="math inline">\(\alpha\)</span> value, first find <span class="math inline">\(q\)</span> variables that have nonzero regression coefficients and then compute the ordinary least square estimate for the corresponding <span class="math inline">\(q\)</span> variables. Note that the ordinary least square estimate cannot be computed when <span class="math inline">\(q \geq n_{tr}\)</span>, so we only select the first <span class="math inline">\(n_{tr} - 1\)</span> variables in this case. Your optimal <span class="math inline">\(\hat{\lambda}_{\min}\)</span> and <span class="math inline">\(\hat{\lambda}_{1\text{se}}\)</span> should be determined based on <span class="math inline">\(PE_{new}\)</span> of the 5-fold cross validation. For lasso (<span class="math inline">\(\alpha = 1\)</span>), find the numerical values of <span class="math inline">\(\hat{\lambda}_{\min}\)</span> and <span class="math inline">\(\hat{\lambda}_{1\text{se}}\)</span>, and provide the number of selected variables for the corresponding <span class="math inline">\(\hat{\lambda}_{\min}\)</span> and <span class="math inline">\(\hat{\lambda}_{1\text{se}}\)</span>, respectively.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>K <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>lambda.num <span class="ot">&lt;-</span> <span class="fu">length</span>(lambda)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>pe.new <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,K,lambda.num)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>K){</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a> tran <span class="ot">&lt;-</span> <span class="fu">which</span>(foldid<span class="sc">!=</span>k)</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a> test <span class="ot">&lt;-</span> <span class="fu">which</span>(foldid<span class="sc">==</span>k)</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a> fit.q4 <span class="ot">&lt;-</span> <span class="fu">glmnet</span>(x[tran,],y[tran],<span class="at">alpha=</span><span class="dv">1</span>,<span class="at">lambda=</span>lambda,<span class="at">family=</span><span class="st">'gaussian'</span>)</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a> <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>lambda.num){</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a> <span class="cf">if</span>(<span class="fu">sum</span>(fit.q4<span class="sc">$</span>beta[,i]<span class="sc">!=</span><span class="dv">0</span>)<span class="sc">!=</span><span class="dv">0</span>){</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a> gene.pos <span class="ot">&lt;-</span> <span class="fu">which</span>(fit.q4<span class="sc">$</span>beta[,i]<span class="sc">!=</span><span class="dv">0</span>)</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a> q <span class="ot">&lt;-</span> <span class="fu">length</span>(gene.pos)</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a> q0 <span class="ot">&lt;-</span> <span class="fu">min</span>(q,<span class="fu">length</span>(tran)<span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a> lm.fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(y<span class="sc">~</span>x[,gene.pos[<span class="dv">1</span><span class="sc">:</span>q0]],<span class="at">subset=</span>tran)</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a> lm.pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(lm.fit,<span class="fu">data.frame</span>(x[,gene.pos[<span class="dv">1</span><span class="sc">:</span>q0]]))</span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a> pe.new[k,i] <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>((y<span class="sc">-</span>lm.pred)[test]<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a> }<span class="cf">else</span>{</span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a> beta0 <span class="ot">&lt;-</span> <span class="fu">mean</span>(y[tran])</span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a> pe.new[k,i] <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>((y[test]<span class="sc">-</span>beta0)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a> }</span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a> }</span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a>pe.new.ave <span class="ot">&lt;-</span> <span class="fu">apply</span>(pe.new,<span class="dv">2</span>,mean)</span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a>lambda.min <span class="ot">&lt;-</span> lambda[<span class="fu">which</span>(pe.new.ave<span class="sc">==</span><span class="fu">min</span>(pe.new.ave))]</span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a>pe.new.sd <span class="ot">&lt;-</span> <span class="fu">apply</span>(pe.new,<span class="dv">2</span>,sd)</span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a>pe.new.up <span class="ot">&lt;-</span> pe.new.ave<span class="sc">+</span>pe.new.sd</span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a>lambda<span class="fl">.1</span>se <span class="ot">&lt;-</span> lambda[<span class="fu">min</span>(<span class="fu">which</span>(pe.new.ave <span class="sc">&lt;</span></span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a>pe.new.up[<span class="fu">which</span>(pe.new.ave<span class="sc">==</span><span class="fu">min</span>(pe.new.ave))]))]</span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a>fit.min <span class="ot">&lt;-</span> <span class="fu">glmnet</span>(x,y,<span class="at">alpha=</span><span class="dv">1</span>,<span class="at">lambda=</span>lambda.min,<span class="at">family=</span><span class="st">'gaussian'</span>)</span>
<span id="cb4-29"><a href="#cb4-29" aria-hidden="true" tabindex="-1"></a>num.min <span class="ot">&lt;-</span> <span class="fu">sum</span>(fit.min<span class="sc">$</span>beta<span class="sc">!=</span><span class="dv">0</span>)</span>
<span id="cb4-30"><a href="#cb4-30" aria-hidden="true" tabindex="-1"></a>fit<span class="fl">.1</span>se <span class="ot">&lt;-</span> <span class="fu">glmnet</span>(x,y,<span class="at">alpha=</span><span class="dv">1</span>,<span class="at">lambda=</span>lambda<span class="fl">.1</span>se,<span class="at">family=</span><span class="st">'gaussian'</span>)</span>
<span id="cb4-31"><a href="#cb4-31" aria-hidden="true" tabindex="-1"></a>num<span class="fl">.1</span>se <span class="ot">&lt;-</span> <span class="fu">sum</span>(fit<span class="fl">.1</span>se<span class="sc">$</span>beta<span class="sc">!=</span><span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>The numerical value of <span class="math inline">\(\hat{\lambda}_{\min}\)</span> = 1.2216773 <br> The numerical value of <span class="math inline">\(\hat{\lambda}_{1\text{se}}\)</span> = 2.5587435<br><br></p>
<p>The number of variables of <span class="math inline">\(\hat{\lambda}_{\min}\)</span> = 15<br> The number of variables of <span class="math inline">\(\hat{\lambda}_{1\text{se}}\)</span> = 1</p>
</section>
<section id="question-5" class="level2">
<h2 class="anchored" data-anchor-id="question-5">Question 5</h2>
<p>Repeat Q4 with the elastic-net, where the tuning parameter <span class="math inline">\(\alpha\)</span> starts from 0 to 1 increased by 0.05. Suppose that <span class="math inline">\(\alpha\)</span> minimizes _{} among all <span class="math inline">\(\alpha\)</span>. Find the optimal value of <span class="math inline">\(\hat{\alpha}\)</span> and the corresponding <span class="math inline">\(\hat{\lambda}_{\min}\)</span> and <span class="math inline">\(\hat{\lambda}_{1\text{se}}\)</span>. Also provide the number of selected variables for <span class="math inline">\(\hat{\lambda}_{\min}\)</span> and <span class="math inline">\(\hat{\lambda}_{1\text{se}}\)</span>, respectively.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="do">###Q5</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>pe.new <span class="ot">&lt;-</span> <span class="fu">array</span>(<span class="cn">NA</span>,<span class="fu">c</span>(<span class="fu">length</span>(alpha),lambda.num,K))</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>K){</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a> tran <span class="ot">&lt;-</span> <span class="fu">which</span>(foldid<span class="sc">!=</span>k)</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a> test <span class="ot">&lt;-</span> <span class="fu">which</span>(foldid<span class="sc">==</span>k)</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a> <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(alpha)){</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a> fit.q5 <span class="ot">&lt;-</span> <span class="fu">glmnet</span>(x[tran,],y[tran],<span class="at">alpha=</span>alpha[i],<span class="at">lambda=</span>lambda,<span class="at">family=</span><span class="st">'gaussian'</span>)</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a> <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>lambda.num){</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a> <span class="cf">if</span>(<span class="fu">sum</span>(fit.q5<span class="sc">$</span>beta[,j]<span class="sc">!=</span><span class="dv">0</span>)<span class="sc">!=</span><span class="dv">0</span>){</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a> gene.pos <span class="ot">&lt;-</span> <span class="fu">which</span>(fit.q5<span class="sc">$</span>beta[,j]<span class="sc">!=</span><span class="dv">0</span>)</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a> q <span class="ot">&lt;-</span> <span class="fu">length</span>(gene.pos)</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a> q0 <span class="ot">&lt;-</span> <span class="fu">min</span>(q,<span class="fu">length</span>(tran)<span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a> lm.fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(y<span class="sc">~</span>x[,gene.pos[<span class="dv">1</span><span class="sc">:</span>q0]],<span class="at">subset=</span>tran)</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a> lm.pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(lm.fit,<span class="fu">data.frame</span>(x[,gene.pos[<span class="dv">1</span><span class="sc">:</span>q0]]))</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a> pe.new[i,j,k] <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>((y<span class="sc">-</span>lm.pred)[test]<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a> }<span class="cf">else</span>{</span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a> beta0 <span class="ot">&lt;-</span> <span class="fu">mean</span>(y[tran])</span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a> pe.new[i,j,k] <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>((y[test]<span class="sc">-</span>beta0)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a> }</span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a> }</span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a> }</span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a>cv.ave <span class="ot">&lt;-</span> <span class="fu">apply</span>(pe.new,<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>),mean)</span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a>cv.alpha <span class="ot">&lt;-</span> <span class="fu">apply</span>(cv.ave,<span class="dv">1</span>,min)</span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a>alpha.hat <span class="ot">&lt;-</span> alpha[<span class="fu">which</span>(cv.alpha<span class="sc">==</span><span class="fu">min</span>(cv.alpha))]</span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a>cv.lambda <span class="ot">&lt;-</span> pe.new[<span class="fu">which</span>(cv.alpha<span class="sc">==</span><span class="fu">min</span>(cv.alpha)),,]</span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a>cv.lambda.ave <span class="ot">&lt;-</span> <span class="fu">apply</span>(cv.lambda,<span class="dv">1</span>,mean)</span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true" tabindex="-1"></a>cv.lambda.se <span class="ot">&lt;-</span> <span class="fu">apply</span>(cv.lambda,<span class="dv">1</span>,sd)</span>
<span id="cb5-29"><a href="#cb5-29" aria-hidden="true" tabindex="-1"></a>cv.lambda.up <span class="ot">&lt;-</span> cv.lambda.ave <span class="sc">+</span> cv.lambda.se</span>
<span id="cb5-30"><a href="#cb5-30" aria-hidden="true" tabindex="-1"></a>lambda.min.pos <span class="ot">&lt;-</span> <span class="fu">which</span>(cv.lambda.ave<span class="sc">==</span><span class="fu">min</span>(cv.lambda.ave))</span>
<span id="cb5-31"><a href="#cb5-31" aria-hidden="true" tabindex="-1"></a>lambda.min <span class="ot">&lt;-</span> lambda[lambda.min.pos]</span>
<span id="cb5-32"><a href="#cb5-32" aria-hidden="true" tabindex="-1"></a>lambda<span class="fl">.1</span>se.pos <span class="ot">&lt;-</span> <span class="fu">min</span>(<span class="fu">which</span>(cv.lambda.ave <span class="sc">&lt;</span></span>
<span id="cb5-33"><a href="#cb5-33" aria-hidden="true" tabindex="-1"></a>cv.lambda.up[<span class="fu">which</span>(cv.lambda.ave<span class="sc">==</span><span class="fu">min</span>(cv.lambda.ave))]))</span>
<span id="cb5-34"><a href="#cb5-34" aria-hidden="true" tabindex="-1"></a>lambda<span class="fl">.1</span>se <span class="ot">&lt;-</span> lambda[lambda<span class="fl">.1</span>se.pos]</span>
<span id="cb5-35"><a href="#cb5-35" aria-hidden="true" tabindex="-1"></a>fit.min <span class="ot">&lt;-</span> <span class="fu">glmnet</span>(x,y,<span class="at">alpha=</span>alpha.hat,<span class="at">lambda=</span>lambda.min,<span class="at">family=</span><span class="st">'gaussian'</span>)</span>
<span id="cb5-36"><a href="#cb5-36" aria-hidden="true" tabindex="-1"></a>num.min <span class="ot">&lt;-</span> <span class="fu">sum</span>(fit.min<span class="sc">$</span>beta<span class="sc">!=</span><span class="dv">0</span>)</span>
<span id="cb5-37"><a href="#cb5-37" aria-hidden="true" tabindex="-1"></a>fit<span class="fl">.1</span>se <span class="ot">&lt;-</span> <span class="fu">glmnet</span>(x,y,<span class="at">alpha=</span>alpha.hat,<span class="at">lambda=</span>lambda<span class="fl">.1</span>se,<span class="at">family=</span><span class="st">'gaussian'</span>)</span>
<span id="cb5-38"><a href="#cb5-38" aria-hidden="true" tabindex="-1"></a>num<span class="fl">.1</span>se <span class="ot">&lt;-</span> <span class="fu">sum</span>(fit<span class="fl">.1</span>se<span class="sc">$</span>beta<span class="sc">!=</span><span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>The optimal value of <span class="math inline">\(\hat{\alpha}\)</span> = 0.95<br><br></p>
<p>The corresponding value of <span class="math inline">\(\hat{\lambda}_{\min}\)</span> = 1.3399553 <br> The corresponding value of <span class="math inline">\(\hat{\lambda}_{1\text{se}}\)</span> = 2.7213388 <br><br></p>
<p>The number of variables of <span class="math inline">\(\hat{\lambda}_{\min}\)</span> = 15 <br> The number of variables of <span class="math inline">\(\hat{\lambda}_{1\text{se}}\)</span> = 1</p>


</section>

<a onclick="window.scrollTo(0, 0); return false;" role="button" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> Back to top</a></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/statsergeant\.quarto\.pub\/statsergeant");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./Machine_learning_hw1.html" class="pagination-link" aria-label="Machine_Learning_HW1">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Machine_Learning_HW1</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./Machine_learning_hw3.html" class="pagination-link" aria-label="Machine_Learning_HW3">
        <span class="nav-page-text">Machine_Learning_HW3</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      <ul class="footer-items list-unstyled">
    <li class="nav-item compact">
      <i class="bi bi-github" role="img">
</i> 
  </li>  
    <li class="nav-item compact">
      <i class="bi bi-instagram" role="img">
</i> 
  </li>  
    <li class="nav-item compact">
      <i class="bi bi-twitter" role="img">
</i> 
  </li>  
    <li class="nav-item compact">
      <i class="bi bi-facebook" role="img">
</i> 
  </li>  
</ul>
    </div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>




</body></html>