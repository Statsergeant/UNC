<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.55">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Machine_Learning_HW5 – Statsergeant</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<link href="./Machine_learning_hw4.html" rel="prev">
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="site_libs/kePrint-0.0.1/kePrint.js"></script>

<link href="site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">


  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./Machine_learning_hw1.html">Machine_Learning</a></li><li class="breadcrumb-item"><a href="./Machine_learning_hw5.html">Machine_Learning_HW5</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Statsergeant</a> 
        <div class="sidebar-tools-main tools-wide">
    <a href="https://github.com/Statsergeant/UNC" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-github"></i></a>
    <a href="" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-instagram"></i></a>
    <a href="" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-twitter"></i></a>
    <a href="" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-facebook"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Introduction</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">About ME</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Masters_thesis</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Masters_thesis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">2024_Spring_statistical_consulting</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Fall2023_stat_consulting.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">2023_Fall_statistical_consulting</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Machine_Learning</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Machine_learning_hw1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Machine_Learning_HW1</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Machine_learning_hw2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Machine_Learning_HW2</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Machine_learning_hw3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Machine_Learning_HW3</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Machine_learning_hw4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Machine_Learning_HW4</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Machine_learning_hw5.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Machine_Learning_HW5</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#question-1" id="toc-question-1" class="nav-link active" data-scroll-target="#question-1">Question 1</a></li>
  <li><a href="#question-2" id="toc-question-2" class="nav-link" data-scroll-target="#question-2">Question 2</a></li>
  <li><a href="#question-3" id="toc-question-3" class="nav-link" data-scroll-target="#question-3">Question 3</a></li>
  <li><a href="#question-4" id="toc-question-4" class="nav-link" data-scroll-target="#question-4">Question 4</a></li>
  <li><a href="#question-5" id="toc-question-5" class="nav-link" data-scroll-target="#question-5">Question 5</a></li>
  <li><a href="#question-6" id="toc-question-6" class="nav-link" data-scroll-target="#question-6">Question 6</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./Machine_learning_hw1.html">Machine_Learning</a></li><li class="breadcrumb-item"><a href="./Machine_learning_hw5.html">Machine_Learning_HW5</a></li></ol></nav>
<div class="quarto-title">
<h1 class="title">Machine_Learning_HW5</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p><br></p>
<p>Perform a simulation study to compare some of classifiers including boosting methods and support vector machines. First, generate the simulation data such that <br></p>
<p>&gt; library(mnormt)<br> &gt; RNGkind(sample.kind = “Rounding”)<br> &gt; set.seed(1111)<br> &gt; K &lt;- 100; n &lt;- 200; p &lt;- 10<br> &gt; x.tran &lt;- x.test &lt;- x.vald &lt;- array(0, c(n, p, K))<br> &gt; z &lt;- rep(c(1,2,3), each=n/2)<br> &gt; covm &lt;- matrix(0.6, p, p); diag(covm) &lt;- 1<br> &gt; for (i in 1:K) {<br> + t &lt;- sample(1:p, 1); s &lt;- sample(1:p, t)<br> + mu &lt;- rep(0,p); mu[s] &lt;- runif(t,-1, 1)<br> + x1 &lt;- rmnorm(3<em>n/2, mu, covm)<br> + x2 &lt;- rmnorm(3</em>n/2, rep(0,p), covm)<br> + x.tran[,,i] &lt;- rbind(x1[z==1,], x2[z==1,])<br> + x.test[,,i] &lt;- rbind(x1[z==2,], x2[z==2,])<br> + x.vald[,,i] &lt;- rbind(x1[z==3,], x2[z==3,])<br> + }<br></p>
<p>In this simulation data, we generate a training set (<strong>x.tran</strong>), a test set (<strong>x.test</strong>) and a validation set (<strong>x.vald</strong>), where the observations of each set consist of 100 cases (<strong>y=1</strong>) for the first 100 observations and 100 controls (<strong>y=0</strong>) for the other 100 observations, i.e., the sample size (<strong>n</strong>) is 200. The number of predictors (<strong>p</strong>) is 10 and the number of simulation replications (<strong>K</strong>) is 100. For the k-th simulation replicate, you have to build a classifier c(x) from the training set (<strong>x.tran[,,k]</strong>) and then compute the classification error rate (<strong>CER</strong>) of the test set (<strong>x.test[,,k]</strong>). The validation set (<strong>x.vald[,,k]</strong>) should be used only for selection of the optimal tuning parameter(<strong>s</strong>), if necessary. The final CER of the classifier c(x) should be averaged over 100 simulation replications.</p>
<section id="question-1" class="level2">
<h2 class="anchored" data-anchor-id="question-1">Question 1</h2>
<p>Based on the training set, build a boosting classifier, using the <strong>gbm</strong> function of the <code>gbm</code> package. Consider 3 different boosting models, where the number of splits is <strong>depth=1, depth=2 or depth=3.</strong> Fix the number of trees as <strong>n.trees=1000</strong> when you predict class labels of the test set. Use the prediction threshold of 0.5 for classification. What are the averaged CERs of the test sets for 3 boosting models? Note that you don’t need to use the validation set in this question.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">RNGkind</span>(<span class="at">sample.kind =</span> <span class="st">"Rounding"</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1111</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>K <span class="ot">&lt;-</span> <span class="dv">100</span>; n <span class="ot">&lt;-</span> <span class="dv">200</span>; p <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>x.tran <span class="ot">&lt;-</span> x.test <span class="ot">&lt;-</span> x.vald <span class="ot">&lt;-</span> <span class="fu">array</span>(<span class="dv">0</span>, <span class="fu">c</span>(n, p, K))</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>), <span class="at">each=</span>n<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>covm <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fl">0.6</span>, p, p); <span class="fu">diag</span>(covm) <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>K){</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a> t <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>p, <span class="dv">1</span>); s <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>p, t)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a> mu <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>,p); mu[s] <span class="ot">&lt;-</span> <span class="fu">runif</span>(t,<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a> x1 <span class="ot">&lt;-</span> <span class="fu">rmnorm</span>(<span class="dv">3</span><span class="sc">*</span>n<span class="sc">/</span><span class="dv">2</span>, mu, covm)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a> x2 <span class="ot">&lt;-</span> <span class="fu">rmnorm</span>(<span class="dv">3</span><span class="sc">*</span>n<span class="sc">/</span><span class="dv">2</span>, <span class="fu">rep</span>(<span class="dv">0</span>,p), covm)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a> x.tran[,,i] <span class="ot">&lt;-</span> <span class="fu">rbind</span>(x1[z<span class="sc">==</span><span class="dv">1</span>,], x2[z<span class="sc">==</span><span class="dv">1</span>,])</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a> x.test[,,i] <span class="ot">&lt;-</span> <span class="fu">rbind</span>(x1[z<span class="sc">==</span><span class="dv">2</span>,], x2[z<span class="sc">==</span><span class="dv">2</span>,])</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a> x.vald[,,i] <span class="ot">&lt;-</span> <span class="fu">rbind</span>(x1[z<span class="sc">==</span><span class="dv">3</span>,], x2[z<span class="sc">==</span><span class="dv">3</span>,])</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">0</span>),<span class="fu">c</span>(<span class="dv">100</span>,<span class="dv">100</span>))</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="do">###Q1</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>boost.miss <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,K,<span class="dv">3</span>)</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>K){</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a> data.tran <span class="ot">&lt;-</span> <span class="fu">cbind</span>(y,x.tran[,,i])</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a> data.test <span class="ot">&lt;-</span> <span class="fu">cbind</span>(y,x.test[,,i])</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a> <span class="fu">colnames</span>(data.tran) <span class="ot">&lt;-</span> <span class="fu">colnames</span>(data.test) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'y'</span>,<span class="fu">paste0</span>(<span class="st">'x'</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>))</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a> <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>){</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a> boost.fit <span class="ot">&lt;-</span></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a><span class="fu">gbm</span>(y<span class="sc">~</span>.,<span class="at">data=</span><span class="fu">data.frame</span>(data.tran),<span class="at">distribution=</span><span class="st">'bernoulli'</span>,<span class="at">n.trees=</span><span class="dv">1000</span>,<span class="at">interaction.depth=</span>j)</span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a> boost.pred <span class="ot">&lt;-</span></span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(boost.fit,<span class="at">newdata=</span><span class="fu">data.frame</span>(data.test),<span class="at">type=</span><span class="st">'response'</span>,<span class="at">n.trees=</span><span class="dv">1000</span>)</span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a> decision <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>,<span class="fu">dim</span>(data.test)[<span class="dv">1</span>])</span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a> decision[boost.pred <span class="sc">&gt;</span> <span class="fl">0.5</span>] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a> boost.miss[i,j] <span class="ot">&lt;-</span> <span class="fu">mean</span>(decision<span class="sc">!=</span>y)</span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a> }</span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a>ans1 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">apply</span>(boost.miss,<span class="dv">2</span>,mean),<span class="dv">1</span>,<span class="dv">3</span>)</span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(ans1) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'Depth=1'</span>,<span class="st">'Depth=2'</span>,<span class="st">'Depth=3'</span>)</span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(ans1) <span class="ot">&lt;-</span> <span class="st">'Boosting'</span></span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a>ans1 <span class="sc">%&gt;%</span> <span class="fu">kable</span>() <span class="sc">%&gt;%</span> <span class="fu">kable_styling</span>(<span class="at">full_width =</span> F)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table caption-top table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Depth=1</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Depth=2</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Depth=3</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Boosting</td>
<td style="text-align: right;">0.23765</td>
<td style="text-align: right;">0.2373</td>
<td style="text-align: right;">0.2387</td>
</tr>
</tbody>
</table>


</div>
</div>
</section>
<section id="question-2" class="level2">
<h2 class="anchored" data-anchor-id="question-2">Question 2</h2>
<p>Repeat Q1 except that we find the optimal number of trees between 1 and 1000, using the validation set. First, build a boosting classifier for the training set. Second, compute the CER of the validation set for each number of trees <strong>n.trees=j</strong>, where j starts from 1 to 1000. Find the optimal number of trees that has the smallest CER of the validation set. If you have multiple number of trees that have the smallest CER, choose the maximum number of trees for the optimal value. Finally, apply the boosting method with the optimal number of tree to the test set. What are the averaged CERs of the test sets for 3 boosting models?</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="do">###Q2</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>depth <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>ntrees <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>boost.opt.miss <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,K,<span class="fu">length</span>(depth))</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>K){</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a> data.tran <span class="ot">&lt;-</span> <span class="fu">cbind</span>(y,x.tran[,,i])</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a> data.test <span class="ot">&lt;-</span> <span class="fu">cbind</span>(y,x.test[,,i])</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a> data.vald <span class="ot">&lt;-</span> <span class="fu">cbind</span>(y,x.vald[,,i])</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a> <span class="fu">colnames</span>(data.tran) <span class="ot">&lt;-</span> <span class="fu">colnames</span>(data.test) <span class="ot">&lt;-</span> <span class="fu">colnames</span>(data.vald) <span class="ot">&lt;-</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="st">'y'</span>,<span class="fu">paste0</span>(<span class="st">'x'</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>))</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a> boost.miss <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,<span class="fu">length</span>(depth),<span class="fu">length</span>(ntrees))</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a> <span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(depth)){</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a> boost.fit <span class="ot">&lt;-</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a><span class="fu">gbm</span>(y<span class="sc">~</span>.,<span class="at">data=</span><span class="fu">data.frame</span>(data.tran),<span class="at">distribution=</span><span class="st">'bernoulli'</span>,<span class="at">n.trees=</span><span class="dv">1000</span>,<span class="at">interaction.depth=</span>k)</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a> <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(ntrees)){</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a> boost.pred <span class="ot">&lt;-</span></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(boost.fit,<span class="at">newdata=</span><span class="fu">data.frame</span>(data.vald),<span class="at">type=</span><span class="st">'response'</span>,<span class="at">n.trees=</span>j)</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a> decision <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>,<span class="fu">dim</span>(data.vald)[<span class="dv">1</span>])</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a> decision[boost.pred <span class="sc">&gt;</span> <span class="fl">0.5</span>] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a> boost.miss[k,j] <span class="ot">&lt;-</span> <span class="fu">mean</span>(decision<span class="sc">!=</span>y)</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a> }</span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a> }</span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a> opt.size <span class="ot">&lt;-</span> <span class="fu">apply</span>(boost.miss,<span class="dv">1</span>,<span class="cf">function</span>(x) <span class="fu">max</span>(<span class="fu">which</span>(x<span class="sc">==</span><span class="fu">min</span>(x))))</span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a> <span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(depth)){</span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a> boost.refit <span class="ot">&lt;-</span></span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a><span class="fu">gbm</span>(y<span class="sc">~</span>.,<span class="at">data=</span><span class="fu">data.frame</span>(data.tran),<span class="at">distribution=</span><span class="st">'bernoulli'</span>,<span class="at">n.trees=</span>opt.size[k],<span class="at">interaction.depth=</span>depth[k])</span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a> boost.repred <span class="ot">&lt;-</span><span class="fu">predict</span>(boost.refit,<span class="at">newdata=</span><span class="fu">data.frame</span>(data.test),<span class="at">type=</span><span class="st">'response'</span>,<span class="at">n.trees=</span>opt.size[k])</span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a>  decision <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>,<span class="fu">dim</span>(data.test)[<span class="dv">1</span>])</span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a> decision[boost.repred <span class="sc">&gt;</span> <span class="fl">0.5</span>] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a> boost.opt.miss[i,k] <span class="ot">&lt;-</span> <span class="fu">mean</span>(decision<span class="sc">!=</span>y)</span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a> }</span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a>ans2 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">apply</span>(boost.opt.miss,<span class="dv">2</span>,mean),<span class="dv">1</span>,<span class="dv">3</span>)</span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(ans2) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'Depth=1'</span>,<span class="st">'Depth=2'</span>,<span class="st">'Depth=3'</span>)</span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(ans2) <span class="ot">&lt;-</span> <span class="st">'Boosting'</span></span>
<span id="cb2-37"><a href="#cb2-37" aria-hidden="true" tabindex="-1"></a>ans2 <span class="sc">%&gt;%</span> <span class="fu">kable</span>() <span class="sc">%&gt;%</span> <span class="fu">kable_styling</span>(<span class="at">full_width =</span> F)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table caption-top table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Depth=1</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Depth=2</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Depth=3</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Boosting</td>
<td style="text-align: right;">0.2257</td>
<td style="text-align: right;">0.2302</td>
<td style="text-align: right;">0.2296</td>
</tr>
</tbody>
</table>


</div>
</div>
</section>
<section id="question-3" class="level2">
<h2 class="anchored" data-anchor-id="question-3">Question 3</h2>
<p>Build a logistic boosting method, using the <strong>LogitBoost</strong> function of the <code>caTools</code> package. Similar to Q2, first build a boosting classifier for the training set, where the number of boosting iteration should be fixed as <strong>nIter=1000</strong>. Second, compute the CER of the validation set for each number of iterations <strong>nIter=j</strong>, where *<strong>j</strong> starts from 1 to 999 increased by 2, e.g., <strong>j=1, j=3, j=5, . . . , j=999</strong>. Consider only odd numbers of iterations because even numbers can make 50:50 for classification, which leads to the prediction result of <strong>NA</strong>. If you have multiple number of iterations that have the smallest CER, choose the maximum number of iterations for the optimal value. Finally, apply the logistic boosting method with the optimal number of boosting iteration to the test set. What is the averaged CER of the test sets for the logistic boosting method?</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="do">###Q3</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>iter <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span>,<span class="dv">999</span>,<span class="dv">2</span>)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>logit.boot.miss <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>K){</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a> logit.boot.fit <span class="ot">&lt;-</span> <span class="fu">LogitBoost</span>(<span class="at">xlearn=</span>x.tran[,,i], <span class="at">ylearn=</span>y, <span class="at">nIter=</span><span class="dv">1000</span>)</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a> vald.miss <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a> <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(iter)){</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a> logit.pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(logit.boot.fit, x.vald[,,i], <span class="at">type =</span><span class="st">'raw'</span>, <span class="at">nIter=</span>iter[j])[,<span class="dv">2</span>]</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a> decision <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>,<span class="fu">dim</span>(x.vald[,,i])[<span class="dv">1</span>])</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a> decision[logit.pred <span class="sc">&gt;</span> <span class="fl">0.5</span>] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a> vald.miss[j] <span class="ot">&lt;-</span> <span class="fu">mean</span>(y<span class="sc">!=</span>decision)</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a> }</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a> opt.iter <span class="ot">&lt;-</span> <span class="fu">max</span>(iter[<span class="fu">which</span>(vald.miss<span class="sc">==</span><span class="fu">min</span>(vald.miss))])</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a> logit.repred <span class="ot">&lt;-</span> <span class="fu">predict</span>(logit.boot.fit,x.test[,,i],<span class="at">type =</span><span class="st">'raw'</span>,<span class="at">nIter=</span>opt.iter)[,<span class="dv">2</span>]</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a> decision <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>,<span class="fu">dim</span>(x.test[,,i])[<span class="dv">1</span>])</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a> decision[logit.repred <span class="sc">&gt;</span> <span class="fl">0.5</span>] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a> logit.boot.miss[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(y<span class="sc">!=</span>decision)</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>ans3 <span class="ot">&lt;-</span> <span class="fu">mean</span>(logit.boot.miss)</span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>ans3 <span class="sc">%&gt;%</span> <span class="fu">kable</span>() <span class="sc">%&gt;%</span> <span class="fu">kable_styling</span>(<span class="at">full_width =</span> F)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table caption-top table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0.24805</td>
</tr>
</tbody>
</table>


</div>
</div>
</section>
<section id="question-4" class="level2">
<h2 class="anchored" data-anchor-id="question-4">Question 4</h2>
<p>Build a support vector machine (SVM) method, using the function <strong>ksvm</strong> of the <code>kernlab</code> package. Apply the linear kernel (<strong>kernel=‘vanilladot’</strong>) and the constrain parameter C which can have 26 different values such as <strong>2^seq(-10,15)</strong>. Do not change any other parameters of the function <strong>ksvm</strong>, i.e., just use the default values. First, build SVM to the training set for each value of C. Second, apply SVM to the validation set and then compute decision values (predicted values) of 200 validation samples. Next, sort 200 decision values from the smallest to the largest such that</p>
<p><span class="math display">\[
\hat{y}_{[1]} &lt; \hat{y}_{[2]} &lt; \cdots &lt; \hat{y}_{[199]} &lt; \hat{y}_{[200]}
\]</span> Each decision value will be used for the threshold of classification. For example, for the i-th validation sample</p>
<p><span class="math display">\[
\hat{c}(x_i) =
\begin{cases}
1 &amp; \text{if } y_i &gt; \hat{y}_{[j]} \\
0 &amp; \text{if } y_i \leq \hat{y}_{[j]}
\end{cases}
\]</span> where yi is the decision value of the <span class="math inline">\(i\)</span>-th validation sample and <span class="math inline">\(\hat{y}_{[j]}\)</span> is the j-th threshold for <span class="math inline">\(j\)</span> = 1, . . . , 200. Find both of the optimal value of the constrain parameter <strong>C</strong> and the optimal value of the threshold that can minimize the CER of validation sets. If you have multiple values of <strong>C</strong> that have the smallest CER, choose the minimum value of <strong>C</strong> for the optimal value. If you have multiple values of thresholds that have the smallest CER, compute the mean of the multiple thresholds and take it for the optimal value of the threshold. Finally, apply SVM with the optimal values of <strong>C</strong> and the threshold to the test set. What is the averaged CER of the test sets for SVM?</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="do">###Q4</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>y.fac <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(y)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>cons <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">^</span><span class="fu">seq</span>(<span class="sc">-</span><span class="dv">10</span>,<span class="dv">15</span>)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>test.miss <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>K){</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a> res.van.temp <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,<span class="fu">length</span>(cons),<span class="dv">2</span>)</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a> <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(cons)){</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a> svm.van.fit <span class="ot">&lt;-</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="fu">ksvm</span>(<span class="at">x=</span>x.tran[,,i],<span class="at">y=</span>y.fac,<span class="at">kernel=</span><span class="st">'vanilladot'</span>,<span class="at">C=</span>cons[j],<span class="at">kpar=</span><span class="fu">list</span>(),<span class="at">type=</span><span class="st">"C-svc"</span>)</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a> svm.van.pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(svm.van.fit,x.vald[,,i],<span class="at">type=</span><span class="st">'decision'</span>)</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a> svm.van.sort <span class="ot">&lt;-</span> <span class="fu">sort</span>(svm.van.pred,<span class="at">decreasing=</span><span class="cn">FALSE</span>)</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>  vald.miss <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a> <span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(svm.van.sort)){</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a> cx.hat <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(svm.van.pred <span class="sc">&gt;</span> svm.van.sort[k],<span class="dv">1</span>,<span class="dv">0</span>)</span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a> vald.miss[k] <span class="ot">&lt;-</span> <span class="fu">mean</span>(y.fac<span class="sc">!=</span>cx.hat)</span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a> }</span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a> res.van.temp[j,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">min</span>(vald.miss)</span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a> res.van.temp[j,<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">mean</span>(svm.van.sort[vald.miss<span class="sc">==</span><span class="fu">min</span>(vald.miss)])</span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a> }</span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a> opt.c <span class="ot">&lt;-</span> cons[<span class="fu">which.min</span>(res.van.temp[,<span class="dv">1</span>])]</span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a> opt.thred <span class="ot">&lt;-</span> res.van.temp[<span class="fu">which.min</span>(res.van.temp[,<span class="dv">1</span>]),<span class="dv">2</span>]</span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a> svm.van.fit <span class="ot">&lt;-</span></span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a><span class="fu">ksvm</span>(<span class="at">x=</span>x.tran[,,i],<span class="at">y=</span>y.fac,<span class="at">kernel=</span><span class="st">'vanilladot'</span>,<span class="at">C=</span>opt.c,<span class="at">kpar=</span><span class="fu">list</span>(),<span class="at">type=</span><span class="st">"C-svc"</span>)</span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a> svm.van.pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(svm.van.fit,x.test[,,i],<span class="at">type=</span><span class="st">'decision'</span>)</span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a> cx.hat <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(svm.van.pred <span class="sc">&gt;</span> opt.thred,<span class="dv">1</span>,<span class="dv">0</span>)</span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a> test.miss[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(y.fac<span class="sc">!=</span>cx.hat)</span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a>ans4 <span class="ot">&lt;-</span> <span class="fu">mean</span>(test.miss)</span>
<span id="cb4-29"><a href="#cb4-29" aria-hidden="true" tabindex="-1"></a>ans4 <span class="sc">%&gt;%</span> <span class="fu">kable</span>() <span class="sc">%&gt;%</span> <span class="fu">kable_styling</span>(<span class="at">full_width =</span> F)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table caption-top table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0.19415</td>
</tr>
</tbody>
</table>


</div>
</div>
</section>
<section id="question-5" class="level2">
<h2 class="anchored" data-anchor-id="question-5">Question 5</h2>
<p>Repeat Q4 with 5 different kernels such as<br></p>
<p>– Radial kernel (<strong>kernel=‘rbfdot’</strong>) <br> – Polynomial kernel (<strong>kernel=‘polydot’</strong>)<br> – Hyperbolic tangent kernel (<strong>kernel=‘tanhdot’</strong>)<br> – Laplacian kernel (<strong>kernel=‘laplacedot’</strong>)<br> – Bessel kernel (<strong>kernel=‘besseldot’</strong>).<br></p>
<p>What are the averaged CERs of the test sets for 5 SVMs?</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="do">###Q5</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>test.miss.res <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,K,<span class="dv">5</span>)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>K){</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>res.rbf.temp <span class="ot">&lt;-</span> res.poly.temp <span class="ot">&lt;-</span> res.tanh.temp <span class="ot">&lt;-</span> res.lap.temp <span class="ot">&lt;-</span> res.bess.temp <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,<span class="fu">length</span>(cons),<span class="dv">2</span>)</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(cons)){</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a> <span class="do">###</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a> svm.rbf.fit <span class="ot">&lt;-</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a><span class="fu">ksvm</span>(<span class="at">x=</span>x.tran[,,i],<span class="at">y=</span>y.fac,<span class="at">kernel=</span><span class="st">'rbfdot'</span>,<span class="at">C=</span>cons[j],<span class="at">kpar=</span><span class="fu">list</span>(),<span class="at">type=</span><span class="st">"C-svc"</span>)</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a> svm.rbf.pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(svm.rbf.fit,x.vald[,,i],<span class="at">type=</span><span class="st">'decision'</span>)</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a> svm.rbf.sort <span class="ot">&lt;-</span> <span class="fu">sort</span>(svm.rbf.pred,<span class="at">decreasing=</span><span class="cn">FALSE</span>)</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a> <span class="do">###</span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a> svm.poly.fit <span class="ot">&lt;-</span></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a><span class="fu">ksvm</span>(<span class="at">x=</span>x.tran[,,i],<span class="at">y=</span>y.fac,<span class="at">kernel=</span><span class="st">'polydot'</span>,<span class="at">C=</span>cons[j],<span class="at">kpar=</span><span class="fu">list</span>(),<span class="at">type=</span><span class="st">"C-svc"</span>)</span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a> svm.poly.pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(svm.poly.fit,x.vald[,,i],<span class="at">type=</span><span class="st">'decision'</span>)</span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a> svm.poly.sort <span class="ot">&lt;-</span> <span class="fu">sort</span>(svm.poly.pred,<span class="at">decreasing=</span><span class="cn">FALSE</span>)</span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a> <span class="do">###</span></span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a> svm.tanh.fit <span class="ot">&lt;-</span></span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a><span class="fu">ksvm</span>(<span class="at">x=</span>x.tran[,,i],<span class="at">y=</span>y.fac,<span class="at">kernel=</span><span class="st">'tanhdot'</span>,<span class="at">C=</span>cons[j],<span class="at">kpar=</span><span class="fu">list</span>(),<span class="at">type=</span><span class="st">"C-svc"</span>)</span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a> svm.tanh.pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(svm.tanh.fit,x.vald[,,i],<span class="at">type=</span><span class="st">'decision'</span>)</span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>  svm.tanh.sort <span class="ot">&lt;-</span> <span class="fu">sort</span>(svm.tanh.pred,<span class="at">decreasing=</span><span class="cn">FALSE</span>)</span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a> <span class="do">###</span></span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a> svm.lap.fit <span class="ot">&lt;-</span></span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a><span class="fu">ksvm</span>(<span class="at">x=</span>x.tran[,,i],<span class="at">y=</span>y.fac,<span class="at">kernel=</span><span class="st">'laplacedot'</span>,<span class="at">C=</span>cons[j],<span class="at">kpar=</span><span class="fu">list</span>(),<span class="at">type=</span><span class="st">"C-svc"</span>)</span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a> svm.lap.pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(svm.lap.fit,x.vald[,,i],<span class="at">type=</span><span class="st">'decision'</span>)</span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a> svm.lap.sort <span class="ot">&lt;-</span> <span class="fu">sort</span>(svm.lap.pred,<span class="at">decreasing=</span><span class="cn">FALSE</span>)</span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true" tabindex="-1"></a> <span class="do">###</span></span>
<span id="cb5-29"><a href="#cb5-29" aria-hidden="true" tabindex="-1"></a> svm.bess.fit <span class="ot">&lt;-</span></span>
<span id="cb5-30"><a href="#cb5-30" aria-hidden="true" tabindex="-1"></a><span class="fu">ksvm</span>(<span class="at">x=</span>x.tran[,,i],<span class="at">y=</span>y.fac,<span class="at">kernel=</span><span class="st">'besseldot'</span>,<span class="at">C=</span>cons[j],<span class="at">kpar=</span><span class="fu">list</span>(),<span class="at">type=</span><span class="st">"C-svc"</span>)</span>
<span id="cb5-31"><a href="#cb5-31" aria-hidden="true" tabindex="-1"></a> svm.bess.pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(svm.bess.fit,x.vald[,,i],<span class="at">type=</span><span class="st">'decision'</span>)</span>
<span id="cb5-32"><a href="#cb5-32" aria-hidden="true" tabindex="-1"></a> svm.bess.sort <span class="ot">&lt;-</span> <span class="fu">sort</span>(svm.bess.pred,<span class="at">decreasing=</span><span class="cn">FALSE</span>)</span>
<span id="cb5-33"><a href="#cb5-33" aria-hidden="true" tabindex="-1"></a> <span class="do">###</span></span>
<span id="cb5-34"><a href="#cb5-34" aria-hidden="true" tabindex="-1"></a> vald.miss.rbf <span class="ot">&lt;-</span> vald.miss.poly <span class="ot">&lt;-</span> vald.miss.tanh <span class="ot">&lt;-</span> vald.miss.lap <span class="ot">&lt;-</span></span>
<span id="cb5-35"><a href="#cb5-35" aria-hidden="true" tabindex="-1"></a>vald.miss.bess <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb5-36"><a href="#cb5-36" aria-hidden="true" tabindex="-1"></a> <span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(y.fac)){</span>
<span id="cb5-37"><a href="#cb5-37" aria-hidden="true" tabindex="-1"></a> <span class="do">###</span></span>
<span id="cb5-38"><a href="#cb5-38" aria-hidden="true" tabindex="-1"></a> cx.hat.rbf <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(svm.rbf.pred <span class="sc">&gt;</span> svm.rbf.sort[k],<span class="dv">1</span>,<span class="dv">0</span>)</span>
<span id="cb5-39"><a href="#cb5-39" aria-hidden="true" tabindex="-1"></a> vald.miss.rbf[k] <span class="ot">&lt;-</span> <span class="fu">mean</span>(y.fac<span class="sc">!=</span>cx.hat.rbf)</span>
<span id="cb5-40"><a href="#cb5-40" aria-hidden="true" tabindex="-1"></a> <span class="do">###</span></span>
<span id="cb5-41"><a href="#cb5-41" aria-hidden="true" tabindex="-1"></a> cx.hat.poly <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(svm.poly.pred <span class="sc">&gt;</span> svm.poly.sort[k],<span class="dv">1</span>,<span class="dv">0</span>)</span>
<span id="cb5-42"><a href="#cb5-42" aria-hidden="true" tabindex="-1"></a> vald.miss.poly[k] <span class="ot">&lt;-</span> <span class="fu">mean</span>(y.fac<span class="sc">!=</span>cx.hat.poly)</span>
<span id="cb5-43"><a href="#cb5-43" aria-hidden="true" tabindex="-1"></a> <span class="do">###</span></span>
<span id="cb5-44"><a href="#cb5-44" aria-hidden="true" tabindex="-1"></a> cx.hat.tanh <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(svm.tanh.pred <span class="sc">&gt;</span> svm.tanh.sort[k],<span class="dv">1</span>,<span class="dv">0</span>)</span>
<span id="cb5-45"><a href="#cb5-45" aria-hidden="true" tabindex="-1"></a> vald.miss.tanh[k] <span class="ot">&lt;-</span> <span class="fu">mean</span>(y.fac<span class="sc">!=</span>cx.hat.tanh)</span>
<span id="cb5-46"><a href="#cb5-46" aria-hidden="true" tabindex="-1"></a> <span class="do">###</span></span>
<span id="cb5-47"><a href="#cb5-47" aria-hidden="true" tabindex="-1"></a> cx.hat.lap <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(svm.lap.pred <span class="sc">&gt;</span> svm.lap.sort[k],<span class="dv">1</span>,<span class="dv">0</span>)</span>
<span id="cb5-48"><a href="#cb5-48" aria-hidden="true" tabindex="-1"></a> vald.miss.lap[k] <span class="ot">&lt;-</span> <span class="fu">mean</span>(y.fac<span class="sc">!=</span>cx.hat.lap)</span>
<span id="cb5-49"><a href="#cb5-49" aria-hidden="true" tabindex="-1"></a> <span class="do">###</span></span>
<span id="cb5-50"><a href="#cb5-50" aria-hidden="true" tabindex="-1"></a> cx.hat.bess <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(svm.bess.pred <span class="sc">&gt;</span> svm.bess.sort[k],<span class="dv">1</span>,<span class="dv">0</span>)</span>
<span id="cb5-51"><a href="#cb5-51" aria-hidden="true" tabindex="-1"></a> vald.miss.bess[k] <span class="ot">&lt;-</span> <span class="fu">mean</span>(y.fac<span class="sc">!=</span>cx.hat.bess)</span>
<span id="cb5-52"><a href="#cb5-52" aria-hidden="true" tabindex="-1"></a> }</span>
<span id="cb5-53"><a href="#cb5-53" aria-hidden="true" tabindex="-1"></a> res.rbf.temp[j,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">min</span>(vald.miss.rbf)</span>
<span id="cb5-54"><a href="#cb5-54" aria-hidden="true" tabindex="-1"></a> res.rbf.temp[j,<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">mean</span>(svm.rbf.sort[vald.miss.rbf<span class="sc">==</span><span class="fu">min</span>(vald.miss.rbf)])</span>
<span id="cb5-55"><a href="#cb5-55" aria-hidden="true" tabindex="-1"></a> res.poly.temp[j,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">min</span>(vald.miss.poly)</span>
<span id="cb5-56"><a href="#cb5-56" aria-hidden="true" tabindex="-1"></a> res.poly.temp[j,<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">mean</span>(svm.poly.sort[vald.miss.poly<span class="sc">==</span><span class="fu">min</span>(vald.miss.poly)])</span>
<span id="cb5-57"><a href="#cb5-57" aria-hidden="true" tabindex="-1"></a> res.tanh.temp[j,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">min</span>(vald.miss.tanh)</span>
<span id="cb5-58"><a href="#cb5-58" aria-hidden="true" tabindex="-1"></a> res.tanh.temp[j,<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">mean</span>(svm.tanh.sort[vald.miss.tanh<span class="sc">==</span><span class="fu">min</span>(vald.miss.tanh)])</span>
<span id="cb5-59"><a href="#cb5-59" aria-hidden="true" tabindex="-1"></a> res.lap.temp[j,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">min</span>(vald.miss.lap)</span>
<span id="cb5-60"><a href="#cb5-60" aria-hidden="true" tabindex="-1"></a> res.lap.temp[j,<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">mean</span>(svm.lap.sort[vald.miss.lap<span class="sc">==</span><span class="fu">min</span>(vald.miss.lap)])</span>
<span id="cb5-61"><a href="#cb5-61" aria-hidden="true" tabindex="-1"></a> res.bess.temp[j,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">min</span>(vald.miss.bess)</span>
<span id="cb5-62"><a href="#cb5-62" aria-hidden="true" tabindex="-1"></a> res.bess.temp[j,<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">mean</span>(svm.bess.sort[vald.miss.bess<span class="sc">==</span><span class="fu">min</span>(vald.miss.bess)]) </span>
<span id="cb5-63"><a href="#cb5-63" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb5-64"><a href="#cb5-64" aria-hidden="true" tabindex="-1"></a> <span class="do">###</span></span>
<span id="cb5-65"><a href="#cb5-65" aria-hidden="true" tabindex="-1"></a> opt.c.rbf <span class="ot">&lt;-</span> cons[<span class="fu">which.min</span>(res.rbf.temp[,<span class="dv">1</span>])]</span>
<span id="cb5-66"><a href="#cb5-66" aria-hidden="true" tabindex="-1"></a> opt.thred.rbf <span class="ot">&lt;-</span> res.rbf.temp[<span class="fu">which.min</span>(res.rbf.temp[,<span class="dv">1</span>]),<span class="dv">2</span>]</span>
<span id="cb5-67"><a href="#cb5-67" aria-hidden="true" tabindex="-1"></a> svm.rbf.fit <span class="ot">&lt;-</span></span>
<span id="cb5-68"><a href="#cb5-68" aria-hidden="true" tabindex="-1"></a><span class="fu">ksvm</span>(<span class="at">x=</span>x.tran[,,i],<span class="at">y=</span>y.fac,<span class="at">kernel=</span><span class="st">'rbfdot'</span>,<span class="at">C=</span>opt.c.rbf,<span class="at">kpar=</span><span class="fu">list</span>(),<span class="at">type=</span><span class="st">"C-svc"</span>)</span>
<span id="cb5-69"><a href="#cb5-69" aria-hidden="true" tabindex="-1"></a> svm.rbf.pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(svm.rbf.fit,x.test[,,i],<span class="at">type=</span><span class="st">'decision'</span>)</span>
<span id="cb5-70"><a href="#cb5-70" aria-hidden="true" tabindex="-1"></a> cx.hat.rbf <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(svm.rbf.pred <span class="sc">&gt;</span> opt.thred.rbf,<span class="dv">1</span>,<span class="dv">0</span>)</span>
<span id="cb5-71"><a href="#cb5-71" aria-hidden="true" tabindex="-1"></a> test.miss.res[i,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">mean</span>(y.fac<span class="sc">!=</span>cx.hat.rbf)</span>
<span id="cb5-72"><a href="#cb5-72" aria-hidden="true" tabindex="-1"></a> <span class="do">###</span></span>
<span id="cb5-73"><a href="#cb5-73" aria-hidden="true" tabindex="-1"></a> opt.c.poly <span class="ot">&lt;-</span> cons[<span class="fu">which.min</span>(res.poly.temp[,<span class="dv">1</span>])]</span>
<span id="cb5-74"><a href="#cb5-74" aria-hidden="true" tabindex="-1"></a> opt.thred.poly <span class="ot">&lt;-</span> res.poly.temp[<span class="fu">which.min</span>(res.poly.temp[,<span class="dv">1</span>]),<span class="dv">2</span>]</span>
<span id="cb5-75"><a href="#cb5-75" aria-hidden="true" tabindex="-1"></a> svm.poly.fit <span class="ot">&lt;-</span></span>
<span id="cb5-76"><a href="#cb5-76" aria-hidden="true" tabindex="-1"></a><span class="fu">ksvm</span>(<span class="at">x=</span>x.tran[,,i],<span class="at">y=</span>y.fac,<span class="at">kernel=</span><span class="st">'polydot'</span>,<span class="at">C=</span>opt.c.poly,<span class="at">kpar=</span><span class="fu">list</span>(),<span class="at">type=</span><span class="st">"C-svc"</span>)</span>
<span id="cb5-77"><a href="#cb5-77" aria-hidden="true" tabindex="-1"></a> svm.poly.pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(svm.poly.fit,x.test[,,i],<span class="at">type=</span><span class="st">'decision'</span>)</span>
<span id="cb5-78"><a href="#cb5-78" aria-hidden="true" tabindex="-1"></a> cx.hat.poly <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(svm.poly.pred <span class="sc">&gt;</span> opt.thred.poly,<span class="dv">1</span>,<span class="dv">0</span>)</span>
<span id="cb5-79"><a href="#cb5-79" aria-hidden="true" tabindex="-1"></a> test.miss.res[i,<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">mean</span>(y.fac<span class="sc">!=</span>cx.hat.poly)</span>
<span id="cb5-80"><a href="#cb5-80" aria-hidden="true" tabindex="-1"></a> <span class="do">###</span></span>
<span id="cb5-81"><a href="#cb5-81" aria-hidden="true" tabindex="-1"></a> opt.c.tanh <span class="ot">&lt;-</span> cons[<span class="fu">which.min</span>(res.tanh.temp[,<span class="dv">1</span>])]</span>
<span id="cb5-82"><a href="#cb5-82" aria-hidden="true" tabindex="-1"></a> opt.thred.tanh <span class="ot">&lt;-</span> res.tanh.temp[<span class="fu">which.min</span>(res.tanh.temp[,<span class="dv">1</span>]),<span class="dv">2</span>]</span>
<span id="cb5-83"><a href="#cb5-83" aria-hidden="true" tabindex="-1"></a> svm.tanh.fit <span class="ot">&lt;-</span></span>
<span id="cb5-84"><a href="#cb5-84" aria-hidden="true" tabindex="-1"></a><span class="fu">ksvm</span>(<span class="at">x=</span>x.tran[,,i],<span class="at">y=</span>y.fac,<span class="at">kernel=</span><span class="st">'tanhdot'</span>,<span class="at">C=</span>opt.c.tanh,<span class="at">kpar=</span><span class="fu">list</span>(),<span class="at">type=</span><span class="st">"C-svc"</span>)</span>
<span id="cb5-85"><a href="#cb5-85" aria-hidden="true" tabindex="-1"></a> svm.tanh.pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(svm.tanh.fit,x.test[,,i],<span class="at">type=</span><span class="st">'decision'</span>)</span>
<span id="cb5-86"><a href="#cb5-86" aria-hidden="true" tabindex="-1"></a> cx.hat.tanh <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(svm.tanh.pred <span class="sc">&gt;</span> opt.thred.tanh,<span class="dv">1</span>,<span class="dv">0</span>)</span>
<span id="cb5-87"><a href="#cb5-87" aria-hidden="true" tabindex="-1"></a> test.miss.res[i,<span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="fu">mean</span>(y.fac<span class="sc">!=</span>cx.hat.tanh)</span>
<span id="cb5-88"><a href="#cb5-88" aria-hidden="true" tabindex="-1"></a> <span class="do">###</span></span>
<span id="cb5-89"><a href="#cb5-89" aria-hidden="true" tabindex="-1"></a> opt.c.lap <span class="ot">&lt;-</span> cons[<span class="fu">which.min</span>(res.lap.temp[,<span class="dv">1</span>])]</span>
<span id="cb5-90"><a href="#cb5-90" aria-hidden="true" tabindex="-1"></a> opt.thred.lap <span class="ot">&lt;-</span> res.lap.temp[<span class="fu">which.min</span>(res.lap.temp[,<span class="dv">1</span>]),<span class="dv">2</span>]</span>
<span id="cb5-91"><a href="#cb5-91" aria-hidden="true" tabindex="-1"></a> svm.lap.fit <span class="ot">&lt;-</span></span>
<span id="cb5-92"><a href="#cb5-92" aria-hidden="true" tabindex="-1"></a><span class="fu">ksvm</span>(<span class="at">x=</span>x.tran[,,i],<span class="at">y=</span>y.fac,<span class="at">kernel=</span><span class="st">'laplacedot'</span>,<span class="at">C=</span>opt.c.lap,<span class="at">kpar=</span><span class="fu">list</span>(),<span class="at">type=</span><span class="st">"C-svc"</span>)</span>
<span id="cb5-93"><a href="#cb5-93" aria-hidden="true" tabindex="-1"></a> svm.lap.pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(svm.lap.fit,x.test[,,i],<span class="at">type=</span><span class="st">'decision'</span>)</span>
<span id="cb5-94"><a href="#cb5-94" aria-hidden="true" tabindex="-1"></a> cx.hat.lap <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(svm.lap.pred <span class="sc">&gt;</span> opt.thred.lap,<span class="dv">1</span>,<span class="dv">0</span>)</span>
<span id="cb5-95"><a href="#cb5-95" aria-hidden="true" tabindex="-1"></a> test.miss.res[i,<span class="dv">4</span>] <span class="ot">&lt;-</span> <span class="fu">mean</span>(y.fac<span class="sc">!=</span>cx.hat.lap)</span>
<span id="cb5-96"><a href="#cb5-96" aria-hidden="true" tabindex="-1"></a> <span class="do">###</span></span>
<span id="cb5-97"><a href="#cb5-97" aria-hidden="true" tabindex="-1"></a> opt.c.bess <span class="ot">&lt;-</span> cons[<span class="fu">which.min</span>(res.bess.temp[,<span class="dv">1</span>])]</span>
<span id="cb5-98"><a href="#cb5-98" aria-hidden="true" tabindex="-1"></a> opt.thred.bess <span class="ot">&lt;-</span> res.bess.temp[<span class="fu">which.min</span>(res.bess.temp[,<span class="dv">1</span>]),<span class="dv">2</span>]</span>
<span id="cb5-99"><a href="#cb5-99" aria-hidden="true" tabindex="-1"></a> svm.bess.fit <span class="ot">&lt;-</span></span>
<span id="cb5-100"><a href="#cb5-100" aria-hidden="true" tabindex="-1"></a><span class="fu">ksvm</span>(<span class="at">x=</span>x.tran[,,i],<span class="at">y=</span>y.fac,<span class="at">kernel=</span><span class="st">'besseldot'</span>,<span class="at">C=</span>opt.c.bess,<span class="at">kpar=</span><span class="fu">list</span>(),<span class="at">type=</span><span class="st">"C-svc"</span>)</span>
<span id="cb5-101"><a href="#cb5-101" aria-hidden="true" tabindex="-1"></a> svm.bess.pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(svm.bess.fit,x.test[,,i],<span class="at">type=</span><span class="st">'decision'</span>)</span>
<span id="cb5-102"><a href="#cb5-102" aria-hidden="true" tabindex="-1"></a> cx.hat.bess <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(svm.bess.pred <span class="sc">&gt;</span> opt.thred.bess,<span class="dv">1</span>,<span class="dv">0</span>)</span>
<span id="cb5-103"><a href="#cb5-103" aria-hidden="true" tabindex="-1"></a> test.miss.res[i,<span class="dv">5</span>] <span class="ot">&lt;-</span> <span class="fu">mean</span>(y.fac<span class="sc">!=</span>cx.hat.bess)</span>
<span id="cb5-104"><a href="#cb5-104" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb5-105"><a href="#cb5-105" aria-hidden="true" tabindex="-1"></a>ans5 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">apply</span>(test.miss.res,<span class="dv">2</span>,mean),<span class="dv">1</span>,<span class="dv">5</span>)</span>
<span id="cb5-106"><a href="#cb5-106" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(ans5) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'rbfdot'</span>,<span class="st">'polydot'</span>,<span class="st">'tanhdot'</span>,<span class="st">'laplacedot'</span>,<span class="st">'besseldot'</span>)</span>
<span id="cb5-107"><a href="#cb5-107" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(ans5) <span class="ot">&lt;-</span> <span class="st">'SVM'</span></span>
<span id="cb5-108"><a href="#cb5-108" aria-hidden="true" tabindex="-1"></a>ans5<span class="sc">%&gt;%</span> <span class="fu">kable</span>() <span class="sc">%&gt;%</span> <span class="fu">kable_styling</span>(<span class="at">full_width =</span> F)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table caption-top table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: right;" data-quarto-table-cell-role="th">rbfdot</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">polydot</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">tanhdot</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">laplacedot</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">besseldot</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">SVM</td>
<td style="text-align: right;">0.25515</td>
<td style="text-align: right;">0.19245</td>
<td style="text-align: right;">0.2636</td>
<td style="text-align: right;">0.218</td>
<td style="text-align: right;">0.2212</td>
</tr>
</tbody>
</table>


</div>
</div>
</section>
<section id="question-6" class="level2">
<h2 class="anchored" data-anchor-id="question-6">Question 6</h2>
<p>Based on Q1 ∼ Q5, which classifier is the best in terms of the classification error rate?</p>
<p><strong>The best classifier is SVM with polynomial kernel (kernel=‘polydot’) since it has the smallest classification error rate.</strong></p>


</section>

<a onclick="window.scrollTo(0, 0); return false;" role="button" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> Back to top</a></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/statsergeant\.quarto\.pub\/statsergeant");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./Machine_learning_hw4.html" class="pagination-link" aria-label="Machine_Learning_HW4">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Machine_Learning_HW4</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      <ul class="footer-items list-unstyled">
    <li class="nav-item compact">
      <i class="bi bi-github" role="img">
</i> 
  </li>  
    <li class="nav-item compact">
      <i class="bi bi-instagram" role="img">
</i> 
  </li>  
    <li class="nav-item compact">
      <i class="bi bi-twitter" role="img">
</i> 
  </li>  
    <li class="nav-item compact">
      <i class="bi bi-facebook" role="img">
</i> 
  </li>  
</ul>
    </div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>




</body></html>